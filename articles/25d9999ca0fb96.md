---
title: 'tmux便利！'
emoji: '💬'
type: 'tech' # tech: 技術記事 / idea: アイデア
topics: ['frontend', 'shell']
published: false
---

こんにちは！
最近、お仕事で環境構築をしていて、便利なツールと出会ったので、ご紹介したいと思います！

:::message alert
本記事は、**Mac**を使用して検証したものになります。
Windows だとまた別の挙動をする可能性があります。ご了承ください。
一応、バージョン等の情報を掲載しておきます。

PC：MacBook Pro 13 インチ
OS：macOS Ventura 13.4.1

また、本記事では、**Mac に標準でインストールされているターミナル**を使って説明していきます。
:::

## tmux って何？

tmux とは何か、概要をざっくりと整理しておきます！

### 概要

tmux とは、**端末多重化ソフトウェア（terminal multiplexer）**のことです。
ターミナル画面で、複数のセッションを起動したり、複数のウィンドウを作成したり、1 つのウィンドウで複数のペインに分割することができます。
分割することで、それぞれのペインやウィンドウなどで、それぞれ別々の操作を行うことが可能になります。

#### ひとまず出てきた用語を整理する

端末やらターミナル画面やら用語がいくつか出てきました。
ここでは、Mac を使用する前提で、ターミナル画面(Mac 標準のターミナル)について、調べたことを簡単に記載しておきます。

- Mac 標準のターミナルは、UNIX 系 OS に接続して操作するための「端末エミュレータ」の 1 種で、コマンドラインインターフェース(CLI)を通じて、UNIX 系 OS のコンピュータを操作するためのソフトウェア。
- 「端末」とは、UNIX 系 OS のコンピュータに接続するために使うハードウェア。
- 「端末エミュレータ」とは、UNIX 系 OS のコンピュータに接続するために使う「端末」と同様の動きを、ソフトウェアで実行できるようにしたもののこと。

調べた結果、上記のようなことがわかりました。

### tmux における基本的な用語

tmux を利用するときによく使う、基本的な用語（セッション・ウィンドウ・ペイン）について簡単に整理します。

#### セッション（Session）

セッションとは、1 つ以上のウィンドウのまとまりのこと。

#### ウィンドウ（Window）

ウィンドウとは、1 つ以上のセッションに紐づいた、1 つ以上のペインのまとまりのこと。

#### ペイン（Pane）

ペインとは、1 つのウィンドウに表示されるターミナルエリアのこと。
ターミナルエリアそれぞれが、端末エミュレータ（ターミナル画面）として使用できる。

### 基本的なコマンド操作

基本的なコマンド操作についても簡単にまとめておきます。
tmux では、基本的にプレフィックスキーと操作ごとに指定されたキーを順に押下することで操作することができます。プレフィックスキーは、デフォルトでは、`Ctrl + b`です。

こちらでご紹介しているコマンド操作は一部であり、ほかにも色々あるので、[tmux 公式ドキュメント](https://github.com/tmux/tmux/wiki/Getting-Started#using-tmux-interactively)や[tmux(1) manual page](http://man.openbsd.org/OpenBSD-current/man1/tmux.1)を参照してみてください。

#### セッション関係

セッション関係のコマンドはこちらになります。

| 操作内容                     | コマンド               |
| ---------------------------- | ---------------------- |
| セッションを起動する         | tmux                   |
| 名前付きセッションを起動する | tmux new -s 名前       |
| セッションを一覧表示する     | プレフィックスキー + s |
| セッションを一覧表示する     | tmux list-sessions     |
| セッションを終了する         | exit                   |

#### ペイン関係

ペイン関係のコマンドはこちらになります。

| 操作内容                             | コマンド                            |
| ------------------------------------ | ----------------------------------- |
| ペインを左右に分割する               | tmux splitw -h                      |
| ペインを上下に分割する               | tmux splitw -v                      |
| ペインを左右に分割する               | プレフィックスキー + %              |
| ペインを上下に分割する               | プレフィックスキー + "              |
| ペインを移動する(左右に分割した場合) | プレフィックスキー + 左右の矢印キー |
| ペインを移動する(上下に分割した場合) | プレフィックスキー + 上下の矢印キー |
| 次のペインに移動する                 | プレフィックスキー + o              |
| 前のペインに移動する                 | プレフィックスキー + ;              |
| ペインで時刻を表示する               | プレフィックスキー + t              |
| ペインを終了する                     | exit                                |

#### ウィンドウ関係

ウィンドウ関係のコマンドはこちらになります。

| 操作内容                                 | コマンド               |
| ---------------------------------------- | ---------------------- |
| ウィンドウを作成する                     | プレフィックスキー + c |
| 次のウィンドウに移動する                 | プレフィックスキー + n |
| 前のウィンドウに移動する                 | プレフィックスキー + p |
| ウィンドウを一覧表示                     | プレフィックスキー + w |
| ウィンドウを終了する(確認メッセージあり) | プレフィックスキー + & |
| ウィンドウを終了する                     | exit                   |

## tmux を使ってみる

### tmux を導入する

今回は、Mac を使っているので、Homebrew で導入していきます。
ターミナル画面で、以下のコマンドを実行します。

```
$ brew install tmux
```

Homebrew が入っていない場合は、公式ドキュメントを参照して、インストールしてから上記コマンドを実行します。
[Homebrew 公式ドキュメント](https://brew.sh/)

### 最低限の設定をする

とりあえず、最低限の設定を行なって、tmux を使っていきます。
以下のコマンドを実行して、エディタを開き、設定を行っていきます。

```
$ vi .tmux.conf
```

ターミナル画面上でエディタが開くので、編集を行なっていきます。
特に設定をせずとも使えますが、使い勝手の面から、以下のように設定を編集していきます。

```
set -g prefix C-a
unbind C-b

set-option -g mouse on
```

1 つずつ説明します。

#### プレフィックスキーの変更

以下の設定を記述することで、プレフィックスキーを変更できます。
デフォルトでは、Ctrl + b(C-b)ですが、ご自身が使いやすい、任意のキーに変更することが可能です。以下の設定では、Ctrl + a(C-a)に変更しています。

```
set -g prefix C-a
unbind C-b
```

#### マウス操作を有効にする

以下の設定を記述することで、マウスでペイン選択等の操作ができるようになります。

```
set-option -g mouse on
```

### とりあえず分割してみる

tmux を導入できたので、以下をやってみます。

- ① セッション起動
- ② 複数ウィンドウ作成
- ③ ウィンドウを移動する
- ④ ペイン分割
- ⑤ ペインの移動
- ⑥ ペイン・ウィンドウの終了

#### ① セッション起動

まずは、セッションを起動します。
ターミナル画面で、以下のコマンドを実行します。

```
$ tmux
```

すると、ターミナル画面が次のような画面になるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/e16afe88faed-20230813.png)

ターミナル画面の一番下に緑色のエリアができています。これがステータスラインになります。
ステータスラインでは、セッション名やウィンドウ名が表示されます。`プレフィックスキー + &`でウィンドウを終了するときの確認メッセージも、こちらのステータスラインに表示されます。

#### ② 複数ウィンドウ作成

それでは、複数のウィンドウを作ってみます。
セッションを起動した画面で、`プレフィックスキー + c`というコマンドを実行します。
プレフィックスキーは、`.tmux.conf`で指定しているもの、もしくは指定していない場合は、デフォルトの`Ctrl + b`です。

すると、次のような画面になるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/d84a3970bb8f-20230813.png)

ステータスラインにウィンドウが 1 つ（1:zsh）追加されています。`*`がついているウィンドウ名のウィンドウが現在表示しているウィンドウです。

#### ③ ウィンドウを移動する

次に複数ウィンドウができたので、移動してみます。

まずは、1 つ前のウィンドウに移動します。
`プレフィックスキー + p`で、1 つ前のウィンドウに移動できます。

ターミナル画面は、次のようになるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/6e61003ed05f-20230813.png)
現在表示しているウィンドウを示す`*`が 1 つ前のウィンドウ名のところに変わっています。

では、その次のウィンドウに移動します。
`プレフィックスキー + n`で、次のウィンドウに移動できます。

ターミナル画面は、次のようになるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/be939cf32683-20230813.png)
現在表示しているウィンドウを示す`*`が その次のウィンドウ名のところに変わっています。

#### ④ ペインの分割

それでは、ペインの分割をやってみます。

##### 左右に分割する

ペインを左右に分割するには、`プレフィックスキー + %`もしくは、`tmux splitw -h`というコマンドを実行します。どちらでも大丈夫です。

ターミナル画面は、次のようになるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/4e7b26ce9d34-20230813.png)
左右に分割されています。

##### 上下に分割する

ペインを上下に分割するには、`プレフィックスキー + "`もしくは、`tmux splitw -v`というコマンドを実行します。どちらでも大丈夫です。

ターミナル画面は、次のようになるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/660d6e245c5f-20230813.png)
上下に分割されています。

#### ⑤ ペインの移動

ペインが分割されている状態なので、ペイン間を移動してみたいと思います。
ペイン間の移動は、`プレフィックスキー + 矢印キー`でできます。

1 つ前の項目で上下にペインを分割しているので、上下のペインを移動してみます。
上のペインに移動する場合は、`プレフィックスキー + ↑(矢印キー)`で移動できます。

画面はこのようになるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/5e00202aec77-20230813.png)
カーソルの位置が上のペインに移動しています。

また、下のペインに移動する場合は、`プレフィックスキー + ↓(矢印キー)`で移動できます。

画面はこのようになるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/a6a729f30b70-20230813.png)
カーソルの位置が下のペインに移動しています。

左右にペインを分割している場合は、矢印キーを左右の矢印キーに変えることで移動できるようになります。

また、`プレフィックスキー + o`で次のペインへ、`プレフィックスキー + ;`で前のペインへ移動できるため、そちらのコマンドでペイン間の移動を行うことも可能です。

#### ⑥ ペイン・ウィンドウの終了

複数ウィンドウを作成したり、ペインを複数に分割したりしてきました。
それでは、ペインとウィンドウを終了します。

まずは、複数ペインを分割しているところのペインを終了します。
上下に分割しているので、下の方のペインを終了してみます。
`exit`コマンドを実行します。

![](https://storage.googleapis.com/zenn-user-upload/93ece4744174-20230813.png)

実行すると、次のような画面になるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/59a2cb40892c-20230813.png)
ペインが分割されていない状態に戻りました。

次に、ウィンドウを終了します。
同じように、`exit`コマンドを実行しても良いですし、`プレフィックスキー + &`を使っても良いです。
ここでは、`プレフィックスキー + &`を使ってみます。

すると、次のような画面になるかと思います。ステータスラインが変化しています。
![](https://storage.googleapis.com/zenn-user-upload/f5c3b01fe5c2-20230813.png)
ステータスラインが黄色くなり、`kill-window zsh? (y/n)`というメッセージが表示されています。ステータスラインの黒いカーソルのところで、`y`と入力すると、ウィンドウが終了します。

`y`を選択すると、次のような画面になるかと思います。
![](https://storage.googleapis.com/zenn-user-upload/ab1234dd9364-20230813.png)
先ほどまで、ステータスラインにもう 1 つウィンドウ名が表示されていましたが、もう 1 つのウィンドウは終了し、現在表示しているウィンドウの 1 つのみになっている状態です。

## 実践！

tmux の基本的な動かし方を押さえたところで、シェルスクリプトを使って、実践してみます。

### シェルスクリプトを用意する

- 実際に書いたシェルスクリプトについて紹介。

### シェルスクリプト、実行！

- シェルスクリプトを実行してみて、どうなるかを紹介。

## おわりに

## 参考資料

[tmux 公式ドキュメント](https://github.com/tmux/tmux/wiki)
[とほほの tmux 入門](https://www.tohoho-web.com/ex/tmux.html)
[LinuC Linux 豆知識 104 端末](https://linuc.org/study/knowledge/434/)
[LinuC Linux 豆知識 105 仮想端末（ターミナルエミュレータ）](https://linuc.org/study/knowledge/435/)
[Wikipedia ターミナル (macOS)](<https://ja.wikipedia.org/wiki/%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB_(macOS)>)
[Wikipedia 端末エミュレータ](https://ja.wikipedia.org/wiki/%E7%AB%AF%E6%9C%AB%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BF)
